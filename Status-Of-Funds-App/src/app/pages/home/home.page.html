<app-header title="List of Funds" [goBack]="false"></app-header>
<app-filter></app-filter>

<ion-nav #navCtrl></ion-nav>

<ion-content role="feed">
  <ion-list>
    <div *ngIf="results">
      <ion-item *ngFor="let result of results" detail="true" role="article" (click)="navigate('../fund-details/', result)">
        <ion-label>
          <h2>{{result['Commodity']}}</h2>
          <div *ngIf="result['TransDate'] == '0000-00-00 00:00:00'; then no_date; else date"></div>
          <ng-template #date><p><ion-text color="primary">{{result['AOR']}}</ion-text><ion-text>{{result['TransDate'] | date: 'MM/dd/YYYY'}}</ion-text></p></ng-template>
          <ng-template #no_date><p><ion-text color='primary'>{{result['AOR']}}</ion-text></p></ng-template>
        </ion-label>
        <div *ngIf="result['Obligations'] < 0; then red; else positive"></div>
          <ng-template #red><ion-text color="danger">${{result['Obligations'] | number:'1.2-2'}}</ion-text></ng-template>
          <ng-template #positive>
            <div *ngIf="result['Obligations'] == 0; then black; else green"></div>
            <ng-template #black><ion-text color="dark">${{result['Obligations'] | number:'1.2-2'}}</ion-text></ng-template>
            <ng-template #green><ion-text color="success">${{result['Obligations'] | number:'1.2-2'}}</ion-text></ng-template>
          </ng-template>        
        <ion-button (click)="toggleFlag($event)" fill="clear" color="dark">
          <ion-icon style="height: 24px; width: 24px" name="flag-outline" slot="end"></ion-icon>
        </ion-button>
      </ion-item>
    </div>
  </ion-list>
    <ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
      <ion-infinite-scroll-content
        loadingSpinner="dots"
        loadingText="Loading more funds..."></ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ion-content>
<app-tabs page="home"></app-tabs>
